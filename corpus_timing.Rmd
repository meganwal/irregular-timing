---
title: "Irregular respose times"
author: "Megan Waller and Dan Yurovsky"
date: '`r Sys.Date()`'
output:
  html_document:
  highlight: tango
theme: sandstone
code_folding: show
toc: false
toc_float: false
---
  
```{r libraries}
library(tidyverse)
library(here)
library(ggthemes)
library(glue)

theme_set(theme_few(base_size = 12))

```

```{r helpers}
process_age <- function(age) {
  age_list <- sub("\\['P", "", age) %>%
    sub("D'\\]", "", .) %>%
    str_split(., "[:alpha:]") %>%
    unlist()
  
  as.numeric(age_list[1]) * 365.25 + as.numeric(age_list[2]) * 30.5 +
    as.numeric(age_list[3])
     
}

process_errors <- function(corpus) {
  utts <- read_csv(here(glue("data/{corpus}_utterance_data.csv"))) %>%
    mutate(error = as.logical(error),
           response_time = as.numeric(response_time),
           age = process_age(age)) 

  child_data <- utts %>%
    filter(speaker == "CHI" & responder != "CHI" & (past_tense | plural ))


  child_errors <- child_data %>%
    filter(error)

  child_errors %>%
    select(source_file, age, utterance) %>%
    mutate(overreg_past = "", overreg_plural = "") %>%
    write_csv(here(glue("coded_data/{corpus}_tocode.csv")))
}


```

```{r braunwald, warning = FALSE}
process_errors("braunwald")
```

```{r}
read_errors <- function(corpus) {
  coded <- read_csv(here(glue("coded_data/{corpus}_tocode.csv")))

  return(coded)
}
```

```{r}
braunwald <- read_errors("braunwald")

b_errors <- braunwald %>% 
  filter(overreg_past == TRUE | overreg_plural == TRUE)
```

```{r response-times, eval = FALSE}
ggplot(child_data, aes(x = response_time, color = error))  +
  geom_density()
```
